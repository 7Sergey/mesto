(()=>{"use strict";const e={inputSelector:".popup__input",buttonSubmitSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",activeErrorClass:"popup__error_visible",errorIdTemplate:"-error"},t=class{constructor(e,t){const{inputSelector:s,buttonSubmitSelector:r,inactiveButtonClass:o,inputErrorClass:i,activeErrorClass:n,errorIdTemplate:a}=e;this._form=document.querySelector(t),this._inputList=this._form.querySelectorAll(s),this._buttonSubmit=this._form.querySelector(r),this._inactiveButtonClass=o,this._inputErrorClass=i,this._activeErrorClass=n,this._errorIdTemplate=a,this._errorTextElement=void 0}enableValidation(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_checkInputValidity(e){this._errorTextElement=document.querySelector(`#${e.name}${this._errorIdTemplate}`),e.validity.valid?(this._hideInputError(),this._removeInputClassError(e)):(this._showInputError(e.validationMessage),this._addInputClassError(e))}_hasInvalidInput(){return Array.from(this._inputList).some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this.disableButton():this._enableButton()}_showInputError(e){this._errorTextElement.textContent=e,this._errorTextElement.classList.add(this._activeErrorClass)}_hideInputError(){this._errorTextElement.textContent="",this._errorTextElement.classList.remove(this._activeErrorClass)}_addInputClassError(e){e.classList.add(this._inputErrorClass)}_removeInputClassError(e){e.classList.remove(this._inputErrorClass)}disableButton(){this._buttonSubmit.classList.add(this._inactiveButtonClass),this._buttonSubmit.disabled=!0}_enableButton(){this._buttonSubmit.classList.remove(this._inactiveButtonClass),this._buttonSubmit.disabled=!1}};class s{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup_opened")||e.target.classList.contains("popup__close"))&&this.close()}))}_handleEscClose=e=>{"Escape"===e.key&&this.close()}}class r extends s{constructor({selector:e,handleFormSubmit:t}){super(e),this._form=this._popup.querySelector(".popup__form"),this._handleFormSubmit=t,this._button=this._form.querySelector(".popup__button")}disableButton(){this._button.classList.add("popup__button_disabled"),this._button.disabled=!0}close(){super.close(),this._form.reset()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t),this.close()}))}_getInputValues(){this._inputList=this._form.querySelectorAll(".popup__input");const e={};return this._inputList.forEach((t=>{const s=t.name,r=t.value;e[s]=r})),e}}const o=document.querySelector(".profile__edit-button"),i=document.querySelector(".popup__input_type_name"),n=document.querySelector(".popup__input_type_job"),a=document.querySelector(".profile__add-button"),l=new t(e,".popup__form_new-card"),_=new t(e,".popup__form_profile"),u=new r({selector:".popup_new-card",handleFormSubmit:e=>{p.addItem(m(e)),u.close(),u.disableButton()}}),p=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._items.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",image:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=m(e);p.addItem(t)}},".elements"),c=new class{constructor({userNameSelector:e,userJobSelector:t}){this._userName=document.querySelector(e),this._userJob=document.querySelector(t)}getUserInfo(){return{profile:this._userName.textContent,job:this._userJob.textContent}}setUserInfo({profile:e,job:t}){this._userName.textContent=e,this._userJob.textContent=t}}({userNameSelector:".profile__title",userJobSelector:".profile__subtitle"});p.renderItems(),o.addEventListener("click",(()=>{const e=c.getUserInfo();d.open(),i.value=e.profile,n.value=e.job}));const d=new r({selector:".popup_profile",handleFormSubmit:e=>{c.setUserInfo(e)}}),h=new class extends s{constructor(e){super(e),this._zoomImage=this._popup.querySelector(".popup-zoom__image"),this._zoomTitle=this._popup.querySelector(".popup-zoom__title")}open(e,t){super.open(),this._name=e,this._image=t,this._zoomImage.src=this._image,this._zoomImage.alt=`Увеличенное изображение ${this._name}`,this._zoomTitle.textContent=this._name}}(".popup-zoom");function m(e){return new class{constructor(e,t,s){this._name=e.name,this._image=e.image,this._cardTemplateSelector=s,this._element=void 0,this._handleCardClick=t}_getTemplate(){return document.querySelector(this._cardTemplateSelector).content.querySelector(".elements__item").cloneNode(!0)}_handleCardLike(){this._buttonLike.classList.toggle("elements__button_active")}_handleCardDelete(){this._element.remove()}_setEventListeners(){this._buttonLike.addEventListener("click",(()=>{this._handleCardLike()})),this._buttonDelete.addEventListener("click",(()=>{this._handleCardDelete()})),this._cardImage.addEventListener("click",(()=>{this._handleCardClick({name:this._name,image:this._image})}))}generateCard(){return this._element=this._getTemplate(),this._cardTitle=this._element.querySelector(".card__title"),this._cardTitle.textContent=this._name,this._cardImage=this._element.querySelector(".card__image"),this._cardImage.alt=this._name,this._cardImage.src=this._image,this._buttonDelete=this._element.querySelector(".card__trash-button"),this._buttonLike=this._element.querySelector(".card__button"),this._setEventListeners(),this._element}}(e,(()=>{!function({name:e,image:t}){h.open(e,t)}(e)}),".template").generateCard()}h.setEventListeners(),a.addEventListener("click",(()=>{u.open()})),u.setEventListeners(),d.setEventListeners(),_.enableValidation(),l.enableValidation()})();